# Tealium iQ Extension Documentation: WTA : Passthrough Parameters

## 1. Extension Overview

- **Name**: WTA : Passthrough Parameters
- **ID**: 1090
- **Type**: Javascript Code
- **Scope**: 894
- **Execution Frequency**: Active

### Summary

This extension processes user-defined objects (UDOs) in the Tealium iQ environment by mapping elements that start with the prefix "WTP" to parameters specified in the remaining part of the element name. This allows for flexible data handling and parameter passthrough to various tracking implementations. It enhances the usability of the UDO structure within Tealium by streamlining parameter mappings for analytics.

---

## 2. Code Explanation

### Key Variables

- **`a`**: Represents the event type (e.g., page view, link click).
- **`b`**: Represents the event payload, the object containing UDO elements.
- **`u`**: Represents the tag object, which is used to map parameters.

### Logic Flow

1. The extension is an Immediately Invoked Function Expression (IIFE) that accepts three parameters: `eventType`, `eventPayload`, and `tagObject`.
2. It iterates over each key (UDO element) in the event payload object (`b`).
3. For each key that starts with "WTP:", it performs the following:
   - Removes the "WTP:" prefix using the `substr(4)` method.
   - Maps the new key (without the prefix) to the same value in the `u` object (the tag object).

### Processing Data

The code effectively transforms the shape of the event data being passed through. Each element prefixed with "WTP" is dynamically converted into a standard parameter that can be utilised in subsequent tracking calls.

### Dependencies

This extension relies on the following global objects:
- **`eventType`**: String type event identifier.
- **`eventPayload`**: An object representing the data payload.
- **`tagObject`**: An object used for mapping parameters.

---

## 3. Usage Examples

### Normal Scenario

**Input**: An event payload with multiple UDO elements.
```javascript
{
  "WTP:WT.ti": "This is a page title",
  "WTP:WT.category": "Homepage",
  "otherParam": "Some other value"
}
```

**Output in `tagObject`**:
```javascript
{
  "WT.ti": "This is a page title",
  "WT.category": "Homepage"
}
```
In this normal operation, any element starting with "WTP:" is successfully mapped without additional handling.

### Edge Condition

**Input**: An event payload where no UDO elements start with "WTP".
```javascript
{
  "otherParam": "No passthrough values"
}
```

**Output in `tagObject`**:
```javascript
{}
```
In this edge case, since there are no keys starting with "WTP:", the `tagObject` remains empty, suggesting no passthrough parameters have been found.

---

## 4. Known Limitations & Gotchas

- **Empty Mappings**: If no UDO element has the "WTP:" prefix, `tagObject` will be empty, which can lead to confusion if expecting parameters.
- **Prefix Sensitivity**: The extension strictly checks for the "WTP:" prefix; there is no handling for variations or misspellings.
- **Potential Conflicts**: There may be naming conflicts if other extensions or scripts are also manipulating keys in the UDO with similar or overlapping names.

---

## 5. Recommendations for Refactoring

- **Defensive Checks**: Consider implementing checks for non-string keys to avoid unnecessary mapping attempts.
- **Code Style**: Enhance readability by adding comments for non-obvious code sections or logic.
- **Modularization**: If the extension is expanded, consider separating the mapping logic into a distinct function for clarity and reusability.
- While adhering to ES5 requirements, ensure consistent use of semicolons and whitespace for improved legibility.

---

## 6. Maintenance & Further Notes

- **Ongoing Maintenance**: Regular reviews should be conducted to ensure the extension aligns with evolving data layer structures and mapping needs.
- **Ownership**: Designate a primary owner who will oversee updates and modifications to the extension.
- **Testing Guidelines**: Implement a testing framework that includes unit tests for various use cases. Periodically check compatibility with other extensions.

By adhering to this documentation, developers should find it easier to utilise, maintain, and further enhance the WTA : Passthrough Parameters extension within Tealium iQ.