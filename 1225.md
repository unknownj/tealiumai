# Tealium iQ Extension Documentation: Page Load Adobe Event Triggers

## 1. Extension Overview
- **Name**: Page Load Adobe Event Triggers
- **ID**: 1225
- **Type**: Advanced JavaScript Code
- **Scope**: DOM Ready
- **Execution Frequency**: Run Once

### Summary
This Tealium iQ extension captures specific events during page load and user interactions, facilitating data tracking to Adobe Analytics. It generates a unique identifier for user journeys and listens for specific link clicks, particularly "click-to-call" links, sending corresponding events to the Adobe analytics layer. The extension aims to enhance user journey insights and event tracking metrics.

---

## 2. Code Explanation

### Key Variables
- `window.location.pathname`: Used to check the current page URL for the presence of "/cwa/".
- `window.clova3.datalayer`: A presumed global object responsible for data layer management.
- `e`: A reference to `window.LBGAnalytics.events`, which is utilised to send events to Adobe Analytics.

### Logic Flow
1. **Unique ID Generation**:
   - When the page URL contains "/cwa/", the code generates a unique ID using the current timestamp combined with a random number, encoded in base 36.
   - This unique identifier is set into the data layer under the key `JourneyUniqueID`.

2. **Before Print Event**:
   - The code adds an event listener to the `beforeprint` event, which triggers and sends a generic event (ID: `87`) to Adobe Analytics as part of the print process.

3. **Click Event Tracking**:
   - A click event listener is added to any anchor links that begin with `tel:`, which are commonly used for click-to-call functionality. 
   - When such a link is clicked, an event (ID: `204`) is sent, with additional details about the event (including the link text).

### Dependencies
- The extension depends on several global objects:
  - **`window.clova3.datalayer`**: For managing the data layer.
  - **`window.LBGAnalytics.events`**: For sending events to Adobe Analytics.
  - **`window.clova2.$`**: Likely a jQuery reference for handling DOM events.

---

## 3. Usage Examples

### Normal Conditions
- When a user visits a page with a path that includes `/cwa/`, a unique journey ID is generated and stored, enabling tracking of user sessions.
- Clicking a `tel:` link results in the transmission of an event with pertinent details to Adobe Analytics.

### Edge Conditions
- If a user visits a page without `/cwa/`, no unique ID is created, and thus no data specific to that journey will be recorded.
- If no `<a>` tags exist with `href` beginning with `tel:` on the page, click event tracking will not activate, leading to potentially less data being recorded for user interactions.

---

## 4. Known Limitations & Gotchas
- If the global `window.LBGAnalytics` object is not available, event tracking will fail silently, potentially leading to missing analytics data.
- The extension assumes that the data layer and event handler libraries are loaded prior to its execution.
- Conflicts could arise with other extensions that manipulate the same `beforeprint` event or interact with the same elements on the page, leading to unexpected behaviour.

---

## 5. Recommendations for Refactoring
- **Defensive Checks**: Although not required, consider implementing checks to verify the existence of `window.clova3.datalayer` and `window.LBGAnalytics.events` before attempting to use them.
- **Code Style**: Maintain consistency with variable declarations by preferring `var` for any new variables.
- **Modularization**: Consider breaking the code into smaller functions for better readability. For instance, the ID generation and tracking logic can be encapsulated in individual functions.
- **Separate Event Handlers**: It might be beneficial to define the event handling logic as standalone functions to keep the code clean and enhance reusability.

---

## 6. Maintenance & Further Notes
- **Ongoing Maintenance**: Regularly verify the availability of the dependent global objects to ensure seamless functionality. 
- **Ownership**: Assign a developer to oversee updates and adaptations of the extension to maintain compatibility with evolving project requirements.
- **Testing Guidelines**: Comprehensive testing should be conducted after any updates to the extension, especially on pages with varying URL structures or differing DOM structures to validate event tracking reliability.

---

This documentation provides thorough coverage of the extension, ensuring clarity and insight for developers and stakeholders involved in further utilisation and enhancements.