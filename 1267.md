# Tealium iQ Extension Documentation: SCEP 404

## 1. Extension Overview

- **Name:** SCEP 404
- **ID:** 1267
- **Type:** Advanced Javascript Code
- **Scope:** After Load Rules
- **Execution Frequency:** Run Always

### Summary
The SCEP 404 extension is designed to track events for 404 error pages in a web application. When a page is determined to be a 404 (page not found) based on the canonical link, it triggers an analytics event to inform the tracking system about the occurrence of the error. This extension is important for monitoring user experience and identifying broken links or missing resources on the website.

---

## 2. Code Explanation

### Key Variables
- `a`: Represents the event type that is passed into the function (not utilised in the current code).
- `b`: Represents the event payload, which is an object containing details about the event.

### Logic Flow
1. The code first checks if there is a canonical link (`<link rel="canonical">`) present in the HTML.
2. It retrieves the `href` attribute of this canonical link and analyses it to determine if it contains the substring `"/404."`.
3. If the substring is found, it triggers a generic event (`genericEvent(180)`) using the LBGAnalytics library, indicating that a "Page Not Found" error occurred.

### Dependencies
- **jQuery:** The code relies on jQuery for DOM manipulation to select the canonical link.
- **LBGAnalytics:** This is a custom tracking library that must be included in the website for the code to function. The function `LBGAnalytics.events.genericEvent` is used to send tracking data.

---

## 3. Usage Examples

### Normal Conditions
- When a user navigates to a URL like `https://www.example.com/404.page`, the extension will identify this as a 404 error and send the appropriate tracking event to LBGAnalytics.

### Edge Conditions
- If there is no canonical link present on the page, the extension will simply not execute any tracking code, preventing unnecessary errors or tracking of irrelevant events.
- If the canonical link does not contain the string `"/404."`, the extension will also not trigger the event, maintaining the integrity of the data.

---

## 4. Known Limitations & Gotchas

- **No Error Handling:** The current implementation does not handle cases where jQuery is not loaded, which may lead to undefined behaviours.
- **Single Event Triggering:** The code checks for only one condition (the presence of `"/404."`), which may not account for other variations of 404 error pages if they are structured differently.
- **Potential Conflicts:** If another extension or script modifies the canonical link or the tracking mechanisms in use, it may create conflicts with this extension and lead to inaccurate data collection.

---

## 5. Recommendations for Refactoring

- **Defensive Checks:** Consider adding checks for the presence of jQuery and the canonical link structure. This can help prevent runtime errors if dependencies are missing.
- **Code Modularity:** Breaking the functionality into smaller functions could improve readability and maintainability. For instance, creating a dedicated function to check for the canonical link and another to trigger the event.
- **Consistent Variable Naming:** The current anonymous function accepts parameters `a` and `b`, which are not used. Consider replacing these with more meaningful names or omitting them if unnecessary.

---

## 6. Maintenance & Further Notes

### Ongoing Maintenance
- Regularly update documentation to reflect any changes made to the code or the libraries it depends on.
- Ensure that the LBGAnalytics library is active and up-to-date to avoid any issues with data tracking.

### Ownership
- Assign a team member responsible for monitoring the performance of the extension and managing any issues that arise in production.

### Testing Guidelines
- Conduct regular testing under various scenarios, including pages without a canonical link, incorrectly formatted URLs, and different browser environments to ensure compatibility and performance.

--- 

This documentation serves as a comprehensive guide for developers and stakeholders to understand the functionality, limitations, and recommendations for the SCEP 404 extension in Tealium iQ.