# Tealium iQ Extension Documentation: Set IDs

## 1. Extension Overview

- **Name**: Set IDs
- **ID**: 1486
- **Type**: Advanced Javascript Code
- **Scope**: 928
- **Execution Frequency**: Active

### Summary
The "Set IDs" extension is designed to interface with the LBGAnalytics API, tracking user interactions and events on various web elements. It monitors form fields, sliders, accordions, tooltips, and postcode finder interactions, providing insights into user engagement and behaviour on a webpage. By efficiently capturing this data, it aims to enhance user experience and guide future design decisions.

---

## 2. Code Explanation

**Key Variables:**
- `scepAnalytics`: An object that encapsulates tracking functionality.
- `verboseLogging`: A boolean flag to control logging output.
- `trackedElements`: An array to keep track of various DOM elements that have been instrumented for analytics.

**Logic Flow:**
1. **Initialisation**: The code initializes the `scepAnalytics` object, allowing it to manage various tracking functions.
2. **Event Tracking**: Functions such as `trackEvent` are invoked to send data to LBGAnalytics based on specific user actions (e.g., clicks, changes).
3. **Element Querying**: The `querySelectorAll` function converts NodeLists to arrays and allows for easy element manipulation.
4. **Visibility Tracking**: Utilises the Intersection Observer API to track when elements enter the viewport, allowing efficient performance measurement.
5. **Interaction Logging**: User actions are captured across different component types (postcodes, sliders, forms) and sent to analytics services accordingly.

**Dependencies on Global Objects or Libraries:**
- `window.LBGAnalytics`: Expected to be available for sending tracking events.
- The extension also relies on the `IntersectionObserver` for visibility tracking.

---

## 3. Usage Examples

### Sample Scenario 1: Tracking Postcode Finder Interactions
- When a user interacts with the postcode finder, the extension captures events:
  - The componentâ€™s loading and visibility.
  - First keystroke in the input field.
  - Clicks on the search and manual entry buttons.
  - Selections from the address list.
  
The data is sent to LBGAnalytics under the relevant event actions, enabling real-time insights about how users are engaging with postcode functionalities.

### Sample Scenario 2: Slider Interactions
- A user drags a slider input:
  - The change event triggers tracking, capturing its current value.
  - Additional clicks on increment and decrement arrows also log relevant events to LBGAnalytics, offering visibility into slider usage.

### Edge Condition Example
- If the postcode container is not found, an appropriate log message is displayed: `"No postcode container found"`. This provides clarity on potential issues when the extension cannot function as expected.

---

## 4. Known Limitations & Gotchas

- The extension relies on the presence of `window.LBGAnalytics`. If this object is not available, relevant tracking events cannot be sent, resulting in incomplete data capture.
- Cross-browser compatibility should be tested, especially with the `IntersectionObserver` which may not be supported in legacy browsers.
- Potential for conflicts with other scripts managing similar events or functions.
- If multiple instances of the same element are present, unique tracking might become a challenge since event listeners may be applied to all matching elements.

---

## 5. Recommendations for Refactoring

- **Modularisation**: Consider splitting the `scepAnalytics` code into smaller modules for better readability and maintainability. For example, separate the postcode finder logic into its own module.
- **Defensive Checks**: Although we do not need to handle the presence of `eventType` and `eventPayload`, adding checks for other expected elements can ensure smoother execution. For example, checking if elements exist before adding event listeners to prevent JavaScript errors.
- **Code Style**: Ensure consistent indentation and spacing throughout the code for improved readability. Group related functions together; for instance, all tracking-related functions should be in proximity.
- **Documentation**: Comprehensive inline comments explaining each function and logic block will aid future developers in understanding the codebase.
  
---

## 6. Maintenance & Further Notes

- **Ownership**: Assign a team member to oversee the extension, ensuring continuous monitoring of its performance and addressing any bugs.
- **Testing Guidelines**: Regularly test the extension across different scenarios to validate that events are logged properly. Unit tests should be run for core functions if possible.
- **Versioning and Change Log**: Maintain a version history and change log, documenting all modifications for transparency and traceability.
- **Performance Monitoring**: Regularly check analytics data to ensure accurate tracking. Should discrepancies arise, investigate potential causes, including possible conflicts with other scripts.

---

By following this structured documentation format, stakeholders and fellow developers will have a comprehensive understanding of the "Set IDs" extension, its functionalities, and guidance for effective use and maintenance.