# Tealium iQ Extension Documentation: OD PageRole Override

## 1. Extension Overview

- **Name**: OD PageRole Override
- **ID**: 1582
- **Type**: Javascript Code
- **Scope**: After Load Rules
- **Execution Frequency**: Run Always

### Summary
The OD PageRole Override extension dynamically assigns a `PageRole` to the `eventPayload` based on specific conditions determined by the values of `JourneyName` and `JourneyProduct`. This is crucial for tracking and analytics purposes, ensuring that page engagements are correctly categorised based on various user journeys related to overdraft applications.

## 2. Code Explanation

### Key Variables
- `eventType`: The type of the current event being processed.
- `eventPayload`: An object containing relevant data associated with the current event which will be modified.

### Logic Flow
1. The outer function is invoked with two parameters, `eventType` and `eventPayload`.
2. The code checks if the `JourneyName` property of `eventPayload` is equal to `"ApplyOverdraft"`.
3. If the above condition holds true:
   - It initializes `PageRole` to `"Servicing"`.
   - If `JourneyProduct` is `"Increase"` or `"New"`, it overrides `PageRole` to `"Widgets"`.

### Dependencies
- The code relies on the `eventPayload` object, which is guaranteed to contain properties `JourneyName` and `JourneyProduct`. No external libraries are referenced or required for this functionality.

## 3. Usage Examples

### Normal Conditions
- **Scenario**: A user initiates an overdraft application with the product type set as "New".
    - **Input**: 
        ```javascript
        eventPayload = {
          JourneyName: "ApplyOverdraft",
          JourneyProduct: "New"
        };
        ```
    - **Output**:
        ```javascript
        PageRole = "Widgets";
        ```

- **Scenario**: A user is servicing their existing overdraft but not applying for a new product.
    - **Input**: 
        ```javascript
        eventPayload = {
          JourneyName: "ApplyOverdraft",
          JourneyProduct: "None"
        };
        ```
    - **Output**: 
        ```javascript
        PageRole = "Servicing";
        ```

### Edge Conditions
- **Scenario**: `JourneyName` has a different value.
    - **Input**: 
        ```javascript
        eventPayload = {
          JourneyName: "OtherJourney",
          JourneyProduct: "New"
        };
        ```
    - **Output**: 
        ```javascript
        PageRole remains undefined; no modifications occur.
        ```

## 4. Known Limitations & Gotchas

- If `JourneyName` does not match `"ApplyOverdraft"`, the `PageRole` will not be assigned or modified, leading to potential gaps in tracking for other journeys.
- The extension could conflict with other extensions that also modify the `PageRole` of `eventPayload`. Care should be taken to order the extensions properly in Tealium so that the most relevant or specific logic executes last.
- Depending on browser or user behaviour, if the `JourneyProduct` can be populated with unexpected values (like empty strings or nulls), this may not trigger expected overrides.

## 5. Recommendations for Refactoring

- **Defensive Checks**: While `eventPayload` is guaranteed to be present, validating its properties before usage can improve robustness. For example, you could check that `JourneyProduct` exists and is not null before evaluating its value.
- **Code Style**: Maintain consistent styling and indentation.
- **Modularization**: Consider breaking the function into smaller functions if it grows more complex over time. For this simple logic, it is fine as is, but future enhancements may necessitate a more modular approach.

## 6. Maintenance & Further Notes

- **Ongoing Maintenance**: Regularly review the extensionâ€™s effectiveness, especially if user experiences change or new journeys are introduced. Set a calendar reminder to audit this functionality at regular intervals (e.g., quarterly).
- **Ownership**: Assign a primary owner for this extension who can respond to any issues and keep the documentation updated.
- **Testing Guidelines**: Perform thorough testing in a staging environment before deploying to production, particularly with various `JourneyName` and `JourneyProduct` combinations to ensure expected behaviours across conditions are met.

---

This documentation aims to provide a comprehensive understanding of the OD PageRole Override extension and guide any developer or stakeholder in maintaining and leveraging it effectively.