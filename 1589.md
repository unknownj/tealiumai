# Tealium iQ Extension Documentation: Responsive Sizes

## 1. Extension Overview
- **Name**: Responsive Sizes
- **ID**: 1589
- **Type**: Advanced JavaScript Code
- **Scope**: 928
- **Execution Frequency**: On each event trigger

### Summary
The Responsive Sizes extension determines the responsive size bracket based on the viewport width of the user's device. It generates a descriptive string indicating the current size category (e.g., "Size 2: Up to 480"). This information is appended to the `Presentation` attribute of the `eventPayload` if the `Presentation` type is set to "Responsive". This extension aids in tailoring responses and data collection processes to various screen sizes, enhancing the user experience and data accuracy.

---

## 2. Code Explanation

### Key Variables
- **`opstring`**: A string variable used to store the output that indicates the current responsive size category.
- **`breakpoints`**: An array of predefined breakpoints that includes various widths (in pixels) at which the size categories change.

### Logic Flow
1. **Initialization**: The code starts by declaring the `opstring` and defining the `breakpoints` array.
2. **Breakpoint Evaluation**: A for loop iterates through `breakpoints`. Within the loop:
   - The variables `min` and `max` are set to define range boundaries.
   - For each breakpoint, it determines the current `from` and `to` width limits.
   - It uses the `window.matchMedia` method to check if the viewport width falls between these limits.
   - Based on the results, it builds up `opstring` to describe the matched size category.
3. **Error Handling**: Any exceptions encountered in the try block will result in the `opstring` being set to "Error".
4. **Output Assignment**: If the `Presentation` in the `eventPayload` equals "Responsive", the constructed size description is appended to it.

### Dependencies
The extension relies on the global `window.matchMedia()` method to check media queries for responsive design, which is supported in all modern browsers.

---

## 3. Usage Examples

### Scenario A: Standard Use Case
1. **Event Trigger**: A user visits a website on a mobile device with a screen width of 375px.
2. **Data Flow**: 
   - The extension checks against breakpoints and matches the condition for "Size 2: Up to 480".
   - The `Presentation` field in `eventPayload` becomes "Responsive - Size 2: Up to 480".

### Scenario B: Edge Case
1. **Event Trigger**: A user accesses the site on a desktop with a screen width of 1366px.
2. **Data Flow**:
   - The extension evaluates breakpoints and defines the output as "Size 7: 990 to 1024".
   - Updates `Presentation` to "Responsive - Size 7: 990 to 1024".

### Scenario C: No Match
1. **Event Trigger**: A user visits the site on an ultra-large screen width of 1920px.
2. **Data Flow**:
   - The extension assigns a result of "Size 9: 1600 and above".
   - The `Presentation` is changed accordingly.

---

## 4. Known Limitations & Gotchas
- The extension does not account for "portrait" vs "landscape" orientations, potentially leading to inaccurate size categorisation on certain devices.
- If the media query API is unavailable in the environment, such as in older browsers, the extension will default to "Error" without proper output.
- There might be conflicts or unexpected behaviours if other extensions manipulate the `Presentation` attribute concurrently.

---

## 5. Recommendations for Refactoring
- **Modularisation**: Consider separating responsive size calculations into a standalone function to improve code readability and maintainability.
- **Static Lengths**: Define breakpoints as constants at the top to clarify their purpose.
- **Error Logging**: Instead of setting the `opstring` to "Error", consider logging the error to the console for debugging purposes.
- **Descriptive Comments**: Include inline comments to describe the purpose of key code blocks, making it easier for others to understand the implementation at first glance.

---

## 6. Maintenance & Further Notes
- **Ownership**: Assign a dedicated team member for ongoing maintenance of this extension, ensuring prompt responses to issues or updates based on browser changes.
- **Testing Guidelines**: Ensure regular testing across various devices and screen sizes to validate the functionality and accuracy of breakpoint detection.
- **Documentation Updates**: Keep the documentation up to date with any modifications or extensions to functionality to aid in future development and collaboration.

---

*This documentation serves as a comprehensive guide for understanding and effectively using the Responsive Sizes extension in Tealium iQ. For any queries, please contact the development team.*