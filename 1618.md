# Tealium iQ Extension Documentation: Hatch Cookie Override

## 1. Extension Overview

- **Name**: Hatch Cookie Override
- **ID**: 100036
- **Type**: JavaScript Code
- **Scope**: Pre Loader
- **Execution Frequency**: Run Once

### Summary
The **Hatch Cookie Override** extension is designed to set specific cookie values based on the user's current webpage path. It primarily serves to manage user tracking preferences by modifying cookies when users navigate to predefined URLs within a banking site. This extension ensures that user data handling remains compliant with user choices, thereby fostering a sense of trust and transparency.

---

## 2. Code Explanation

### Key Variables
- **`hatch`**: A boolean variable initialized to `false`. It determines whether the cookie override should be applied based on specific URL conditions.

### Logic Flow
1. The extension first checks the current page's path using `window.location.pathname`.
2. The `indexOf` method is employed to verify if the path starts with `/bankaccounts/youth-student-accounts/`, which would signal that the cookie modifications should be applied.
3. It further checks if the pathname is exactly `/savings/help-guidance/saving-explained/score-your-first-job.html`.
4. If either condition holds true, the variable `hatch` is set to `true`.
5. If `hatch` evaluates to `true`, two cookies are set:
   - `OPTOUTMULTI` with specific multi-value information.
   - `OPTOUTMULTIMESSAGE`, indicating a readiness to opt-out of certain data tracking.

### Dependencies
This script relies on the global object `window` to access the `location` property for obtaining the current URL pathname. It does not depend on any external libraries.

---

## 3. Usage Examples

### Scenario 1: Normal Condition
- **URL**: `/bankaccounts/youth-student-accounts/something.html`
- **Outcome**: Cookies `OPTOUTMULTI` and `OPTOUTMULTIMESSAGE` are set.

### Scenario 2: Exact Path Match
- **URL**: `/savings/help-guidance/saving-explained/score-your-first-job.html`
- **Outcome**: Same as above; both cookies are set.

### Scenario 3: Edge Condition
- **URL**: `/home`
- **Outcome**: Neither cookie is set as the conditions do not match.

### Scenario 4: Unmatched Path
- **URL**: `/bankaccounts/youth-student-accounts/other.html`
- **Outcome**: Cookies are not set because the specific sub-path does not match the conditions.

---

## 4. Known Limitations & Gotchas
- **Cookies May Not Set**: If the specified URL conditions are not met, the cookies will not be set, potentially resulting in the default behaviour of tracking.
- **Conflict with Other Extensions**: This extension could conflict with any other extensions that manipulate cookies or user tracking settings. It is advisable to review cookie-management strategies when deploying multiple extensions.
- **Dependency on URL Path Conciseness**: Since the checks are exclusively for specific strings in the pathname, any updates to the site structure may render the rules ineffective unless updated accordingly.

---

## 5. Recommendations for Refactoring
- **Modularisation**: Break down the logic into smaller functions (e.g., a function to check path matches) for improved readability.
- **Defensive Checks**: Include checks to verify that `window.location` and `window.location.pathname` exist before attempting to access them. This can prevent runtime errors in unusual browser contexts.
- **Code Style**: Maintain consistent use of indentation and spacing for increased readability and adherence to coding standards.
- **Comments**: Add comments within the code to explain the purpose of each conditional block for better maintainability.

---

## 6. Maintenance & Further Notes
- **Ownership**: The team responsible for this extension should designate a lead to oversee updates, especially as website paths evolve.
- **Testing Guidelines**: Test the extension in various environments to ensure it behaves as expected across multiple browsers and devices.
- **Documentation Updates**: Regularly review and update the documentation as the extension evolves or if new scenarios emerge from system changes.

---

This structured documentation underscores the functionality and implementation of the Hatch Cookie Override extension, making it easier for developers and stakeholders to understand and maintain the code.