# Tealium iQ Extension Documentation: Password Complexity Measurement

## 1. Extension Overview

- **Name**: Password Complexity Measurement
- **ID**: 1737
- **Type**: Javascript Code
- **Scope**: After Load Rules
- **Execution Frequency**: Run Always

### Summary
The Password Complexity Measurement extension is designed to evaluate the strength of password inputs on web forms. It calculates a complexity score based on various criteria such as length and character variety. This scoring system helps ensure users create strong passwords, enhancing overall security for user accounts.

---

## 2. Code Explanation

### Key Variables
- **`a`**: Represents the first parameter passed to the IIFE (Immediately Invoked Function Expression); in this context, it may refer to `eventType`.
- **`b`**: Represents the second parameter passed to the IIFE; typically refers to `eventPayload`.
- **`e`**: Each password input element processed in the `querySelectorAll`.
- **`b`**: The value of the password input currently being evaluated.
- **`score`**: An integer representing the complexity score of the password.

### Logic Flow
1. The extension selects all input elements of type password on the document.
2. It maps through these elements and filters them based on two conditions:
   - If there is exactly one password input (does not account for multiple inputs).
   - If the input field has a value.
3. For each valid password input, the password value is evaluated. The scoring is based on the following criteria:
   - Length (1 point for every 4 characters: 8, 12, 16).
   - Presence of at least one lowercase letter.
   - Presence of at least one uppercase letter.
   - Presence of at least one numerical digit.
   - Presence of at least one special character.
4. For each calculated score, it triggers two generic events on LBGAnalytics, indicating password complexity.

### Dependencies
- This code relies on the **LBGAnalytics** object for triggering events.
- It assumes the presence of password input elements on the page.

---

## 3. Usage Examples

### Normal Condition
When a user enters a password that meets several complexity criteria (e.g., "P@ssw0rd1234"), the extension calculates a score of 6. This triggers the `genericEvent(61, 6)` and then `genericEvent(62)`.

### Edge Conditions
- **No Password Input**: If no password fields are present on the page, the extension will not trigger any events.
- **Single Password Input**: If there are multiple password fields, only the first one will be processed, potentially resulting in a misleading complexity score if users are expected to fill out more than one password field.

---

## 4. Known Limitations & Gotchas

- **Multiple Password Fields**: The extension only evaluates a single password input, disregarding the presence of multiple password fields. This could lead to an incomplete assessment of password strength if it is assumed that all fields will be given equal weight.
- **Browser Compatibility**: The use of `Array.from` is not supported in IE11 or other older browsers. Ensure that the target audience is using compatible browsers.
- **Performance Overhead**: Using `querySelectorAll` and array methods might add overhead depending on the number of elements on the page; performance should be monitored.

---

## 5. Recommendations for Refactoring

- **Modularisation**: Extract functionality into separate functions to enhance readability and maintainability. 
    - For example, create a function to calculate the password score.
    - Create a separate function to handle analytics events.
  
- **Sanity Checks**: Before iterating over the password inputs, check if any are found to skip unnecessary processing.
  
- **Comments**: Add inline comments to clarify the purpose of each logical block for future developers.

- **Error Handling**: While it's confirmed `eventType` and `eventPayload` will be present, consider adding more context to analytics events to include metadata regarding the input (e.g., field names) which could be useful in debugging.

---

## 6. Maintenance & Further Notes

- **Ownership**: Assign a team or individual responsible for regular updates and monitoring of the extension's functionality and performance.
  
- **Testing Guidelines**: Establish a systematic approach for testing in various browsers and form configurations, ensuring that both normal and edge scenarios are covered.
  
- **Documentation Updates**: Regularly review and update this documentation to reflect changes in code or functionality based on user feedback or evolving requirements.

By adhering to these guidelines and documenting properly, future developers will have a clearer understanding and better control over the Password Complexity Measurement extension's functionalities.