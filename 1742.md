# Tealium iQ Extension Documentation: Recite Me Tagging

## 1. Extension Overview

- **Name**: Recite Me Tagging
- **ID**: 1742
- **Type**: Javascript Code
- **Scope**: DOM Ready
- **Execution Frequency**: Run Once

### Summary
This extension is designed to track user interactions with the Recite Me accessibility toolbar. It captures various button clicks related to assistive technology features, enabling the collection of valuable analytics data for user engagement. The tracking is initiated based on the user's enablement of the Recite Me functionality through cookies stored in the browser.

---

## 2. Code Explanation

### Key Variables
- **reciteMeEnabled**: A function that checks the presence of a specific cookie (`Recite.Persist=true`) to determine if the Recite Me feature is enabled for the user.
  
- **trackReciteMe**: A function that sets up event listeners to detect button clicks on the Recite Me toolbar and modal buttons. It sends specific analytics events based on the button clicked.

- **trackReciteMeEnablement**: A function that sets up an event listener for the button that enables the Recite Me feature. Once clicked, it triggers the tracking mechanism for user interactions.

### Logic Flow
1. The extension checks if Recite Me is enabled by calling the `reciteMeEnabled` function.
2. If enabled, it invokes the `trackReciteMe` function to listen for user interactions with Recite Me buttons.
3. If not enabled, it calls `trackReciteMeEnablement` to track the click on the enablement button.
4. Interaction events are sent to `LBGAnalytics` with appropriate event details.

### Dependencies
- **LBGAnalytics**: The extension relies on a global object `LBGAnalytics` to send analytics events. This library must be available on the page for the tracking to function correctly.

---

## 3. Usage Examples

### Normal Condition
When a user clicks a button on the Recite Me toolbar:
- The button's ID is checked; for example, if the ID is `recite-toolbar-button-speak`, the event sent will be:
  ```json
  {
    "JourneyEvent": "Assistive Technology",
    "EventAction": "Toolbar Button Click",
    "EventNarrative": "Recite me: Speak"
  }
  ```

### Edge Condition
If a user clicks a button that is not expected, such as an undefined button ID:
- The code safely ignores this event without any reporting, ensuring that no errors are thrown.

### Enablement Flow
If the user clicks the button to enable Recite Me:
- An event is sent indicating that Recite Me has been activated:
  ```json
  {
    "JourneyEvent": "Assistive Technology",
    "EventAction": "Assistive Technology",
    "EventNarrative": "Recite me"
  }
  ```

---

## 4. Known Limitations & Gotchas

- **Cookie Dependency**: The functionality relies on the presence of a cookie, which may not be set if the user is on a new device or has cleared their cookies.
- **Event Listener Duplication**: If the extension is invoked multiple times without a page refresh, it may lead to multiple event listeners being added, causing multiple events to be sent for a single click.
- **Browser Compatibility**: Ensure that event listeners and query selectors are supported across all target browsers, particularly older versions.

---

## 5. Recommendations for Refactoring

- **Modularization**: Consider breaking down the functions into smaller, reusable modules that can be independently tested.
- **Error Handling**: Currently, errors are suppressed (`// do nothing`). Implementing logging could help track issues during debugging.
- **Documenting Constants**: Create constants for string literals (e.g., CSS selectors, cookie names) to avoid potential typos and ease future updates.
- **Avoiding Global Object Dependencies**: Implement checks to ensure `LBGAnalytics` exists before using it, preventing potential errors if the global object is unavailable.

---

## 6. Maintenance & Further Notes

- **Ownership**: Assign a developer or a team responsible for the maintenance and updates of this extension.
- **Testing Guidelines**: Regularly test the extension in different scenarios and browsers to ensure it continues to function as expected, particularly after updates to the Recite Me toolbar or analytics libraries.
- **Documentation Updates**: Keep all documentation up to date with changes in code, logic, or external library dependencies. Encourage contributions and feedback from other developers for improvements.

--- 

This documentation serves as a comprehensive guide to understanding, implementing, and maintaining the Recite Me Tagging extension within Tealium iQ, aiding developers and stakeholders in leveraging assistive technology tracking effectively.