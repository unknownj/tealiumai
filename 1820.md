# Tealium iQ Extension Documentation: Remove utag object if required

## 1. Extension Overview

- **Name:** Remove utag object if required
- **ID:** 1820
- **Type:** Javascript Code
- **Scope:** Pre Loader
- **Execution Frequency:** Run Once

### Summary
This extension is designed to check the presence of the `utag` object in the global window context. If certain conditions are met—specifically, the existence of `utag.globals` and the absence of a `track` method—the extension will create a temporary reference to the `utag` object and subsequently remove the `utag` object from the window. This operation may be necessary to prevent conflicts or issues with tracking when certain conditions within the tag management framework are not met.

## 2. Code Explanation

### Key Variables
- `window.utag`: The global Tealium object that contains methods and data for tag management.
- `window.utag_stub`: A temporary reference to the original `utag` object, created for potential future use after deletion.

### Logic Flow
1. **Condition Check**: The extension first checks if the `utag` object exists, verifies that `utag.globals` is defined, and confirms that the `track` method does not exist.
2. **Storing Reference**: If the conditions are satisfied, it assigns the current `utag` object to a new variable named `window.utag_stub`.
3. **Deletion**: The `utag` object is then removed from the global context by executing `delete window.utag`.

### Dependencies
This extension relies on the following global objects:
- `window`: The global context in which web applications run.
- `utag`: A Tealium object that contains tracking and configuration data. The extension does not depend on any external libraries.

## 3. Usage Examples

### Normal Conditions
When the `utag` object exists and has `utag.globals` defined without the `track` method, the extension's operation is triggered:
- Before execution, `utag` is present in the global scope.
- After execution, `utag_stub` contains the original `utag` object, but `utag` is no longer accessible.

### Edge Conditions
1. **utag Not Defined**: If `utag` is not defined, the condition fails, and the script does nothing.
2. **track Method Exists**: If `track` is present on the `utag` object, the extension will not remove it. This scenario may coincide with successfully implemented tracking.

## 4. Known Limitations & Gotchas
- **Global Impact**: The deletion of the `utag` object may affect other extensions or code that relies on the `utag` object being present.
- **Script Timing**: If this extension runs after other scripts that depend on `utag`, it may result in errors or unexpected behaviours.

## 5. Recommendations for Refactoring
- **Defensive Checks**: While the extension is currently straightforward, consider adding checks to ensure that other properties of `utag` do not conflict with expectations during runtime.
- **Code Style**: Maintain clear and consistent coding standards. Adding comments to explain the logic behind conditions could improve readability.
- **Modularisation**: If the code grows more complex, separate logic into functions for easier maintenance and testing.

## 6. Maintenance & Further Notes
- **Ongoing Maintenance**: Regularly review the extension's performance especially after updates or changes to the Tealium script.
- **Ownership**: Assign a specific owner or team responsible for monitoring the functionality and resolving any arising issues.
- **Testing Guidelines**: Conduct comprehensive testing in various environments to capture edge cases. This ensures proper behaviour with the expected tracking standards and during possible integrations with other scripts.

--- 

This documentation should provide a thorough understanding of the extension, its purpose, and its functionality, enabling other developers and stakeholders to effectively implement and maintain the code within their own Tealium iQ setups.