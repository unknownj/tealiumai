# Tealium iQ Extension Documentation: Signly Tag Code

## 1. Extension Overview

- **Name**: Signly Tag Code
- **ID**: 1916
- **Type**: Javascript Code
- **Scope**: 1643
- **Execution Frequency**: On page load

### Summary
The Signly Tag Code extension is designed to inject a stylesheet and a script from the Signly CDN into the web application. It interacts with the Assistive Technology features provided by Signly, tracking user interactions such as page load and button clicks for translation requests. The extension aims to enhance accessibility by allowing users to request translations and interact with translated content seamlessly.

---

## 2. Code Explanation

### Key Variables

- **SIGNLY_ENDPOINT**: The base URL for the Signly resources. 
- **SIGNLY_STYLESHEET**: Filename of the CSS stylesheet for styling.
- **SIGNLY_SCRIPT**: Filename of the JavaScript file needed for functionality.

### Logic Flow
1. **Initialisation Check**: The extension checks if it has already been initialized. If it has, the function exits to avoid re-initialisation.
2. **Inject Styles and Scripts**: It appends the Signly stylesheet and script to the document's head and body, ensuring they are available for use.
3. **Event Tracking**: 
   - After a delay of 1 second, it sends an analytics event indicating that Assistive Technology has been loaded.
   - It listens for click events and sends various analytics events depending on user interactions with specific elements related to Signly (buttons and video buttons).
4. **Logo Fixing**: A periodic function checks for the Signly logo. If found, it assigns a specific class for styling.

### Dependencies
- The code relies on the `LBGAnalytics` object for:
  - Creating elements and appending them to the DOM.
  - Sending analytics events.
- The code also assumes that the page will have certain elements (like the Signly logo) to modify class attributes.

---

## 3. Usage Examples

### Scenario 1: Normal Operation
- When a user visits the Lloyds Banking Group website, the extension loads after 1 second, sending an event: 
   ```
   {
     JourneyEvent: "Assistive Technology",
     EventAction: "Assistive Technology",
     EventNarrative: "Signly Loaded"
   }
   ```

### Scenario 2: User Interaction with Translation Button
- If a user clicks on a button with the class `signly-button translated`, this event is sent:
   ```
   {
     JourneyEvent: "Assistive Technology",
     EventAction: "Request Translation",
     EventNarrative: "Signly: www.lloydsbankinggroup.com/path"
   }
   ```

### Edge Conditions
- If the Signly logo element does not exist, it gracefully handles this without throwing an error. It will simply skip any actions related to the logo.

---

## 4. Known Limitations & Gotchas

- **Initialisation Gaps**: If the script loads multiple times (e.g., page reloads), it may not execute multiple initialisation actions, but the analytics events could still be sent multiple times.
- **Global Dependencies**: Any changes in the global `LBGAnalytics` object could break functionality.
- **Browser Compatibility**: The extension relies on standard DOM API methods that may not be fully supported in older browsers.

---

## 5. Recommendations for Refactoring

- **Modularisation**: Consider separating distinct functionalities into separate functions for better readability and maintainability.
- **Error Handling**: While the extension has basic try-catch blocks, logging specific errors could provide better insight into failures.
- **Performance Improvements**: Using a single `setInterval` for logo fixing and other functionalities could reduce the load on the browser.
- **Use of Constants**: While the variables are declared once, using an object to encapsulate them would enhance clarity and maintainability.

---

## 6. Maintenance & Further Notes

- **Ownership**: Assign specific team members for monitoring the extensionâ€™s performance and updates.
- **Testing Guidelines**: Ensure that all new changes are validated across different browsers and devices. Regularly test the extension's interactions with various components of the website.
- **Documentation**: Keep this documentation updated whenever changes are made to the code to ensure developers can understand and maintain it effectively.

---

This documentation serves as a comprehensive guide for understanding and maintaining the Signly Tag Code extension in Tealium iQ.